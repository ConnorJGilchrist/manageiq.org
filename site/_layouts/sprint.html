---
layout: page
---

{% for sprint in site.data.sprint_artifacts %}
    {% if sprint.number == page.sprint_number %}
        {% assign sprint_artifact = sprint %}
        {% break %}
    {% endif %}
{% endfor %}

{% assign sprints_key = page.sprint_number | prepend: "prs_" %}
{% assign sprint = site.data.sprints[sprints_key] %}

<h2>Repository Activity between {{ sprint_artifact.start_date }} and {{ sprint_artifact.end_date }}</h2>

<div class="table-responsive">
    <table class="table table-bordered table-hover">
        <tr>
            <th>GitHub Repository</th>
            <th>PRs Created</th>
            <th>PRs Merged</th>
            <th>PRs Closed</th>
            <th>PRs Remaining Open</th>
        </tr>
        {% for repo in sprint %}
            {% if repo.counts.opened == 0 and repo.counts.closed_merged == 0 and repo.counts.closed_unmerged == 0 %}
                {% continue %}
            {% endif %}
            {% assign github_url_prefix = repo.repo_slug | prepend: "https://github.com/issues?utf8=%E2%9C%93&q=repo%3A" %}
            {% assign github_prs_url_prefix = github_url_prefix | append: "+is:pr" %}
            {% assign sprint_start = sprint_artifact.start_date | date: "%F" %}
            {% assign sprint_end   = sprint_artifact.end_date   | date: "%F" %}
            {% assign sprint_range = sprint_start | append: ".." | append: sprint_end %}
            <tr>
                <td><a href="{{ repo.repo_url }}">{{ repo.repo_slug }}</a></td>
                {% if repo.counts.opened > 0 %}
                    {% assign github_url = github_prs_url_prefix | append: "+created:" | append: sprint_range %}
                    <td><a href="{{ github_url }}">{{ repo.counts.opened }}</a></td>
                {% else %}
                    <td>{{ repo.counts.opened }}</td>
                {% endif %}
                {% if repo.counts.closed_merged > 0 %}
                    {% assign github_url = github_prs_url_prefix | append: "+is:merged+closed:" | append: sprint_range %}
                    <td><a href="{{ github_url }}">{{ repo.counts.closed_merged }}</a></td>
                {% else %}
                    <td>{{ repo.counts.closed_merged }}</td>
                {% endif %}
                {% if repo.counts.closed_unmerged > 0 %}
                    {% assign github_url = github_prs_url_prefix | append: "+is:unmerged+closed:" | append: sprint_range %}
                    <td><a href="{{ github_url }}">{{ repo.counts.closed_unmerged }}</a></td>
                {% else %}
                    <td>{{ repo.counts.closed_unmerged }}</td>
                {% endif %}
                {% if repo.counts.still_open > 0 %}
                    {% assign still_open_url   = github_prs_url_prefix | append: "+state:open+created:<="   | append: sprint_end %}
                    {% assign closed_after_url = github_prs_url_prefix | append: "+state:closed+created:<=" | append: sprint_end | append: "+closed:>" | append: sprint_end %}
                    <td>{{ repo.counts.still_open }} (<a href="{{ still_open_url }}">Open</a> + <a href="{{ closed_after_url }}">Closed</a>)</td>
                {% else %}
                    <td>{{ repo.counts.still_open }}</td>
                {% endif %}
            </tr>
        {% endfor %}
    </table>
</div>

<h2>Inactive Repositories</h2>

<div class="table-responsive">
    <table class="table table-bordered table-hover">
        <tr>
            <th>GitHub Repository</th>
            <th>PRs Remaining Open</th>
        </tr>
        {% for repo in sprint %}
            {% if repo.counts.opened > 0 or repo.counts.closed_merged > 0 or repo.counts.closed_unmerged > 0 %}
                {% continue %}
            {% endif %}
            {% assign github_url_prefix = repo.repo_slug | prepend: "https://github.com/issues?utf8=%E2%9C%93&q=repo%3A" %}
            {% assign github_prs_url_prefix = github_url_prefix | append: "+is:pr" %}
            {% assign sprint_start = sprint_artifact.start_date | date: "%F" %}
            {% assign sprint_end   = sprint_artifact.end_date   | date: "%F" %}
            {% assign sprint_range = sprint_start | append: ".." | append: sprint_end %}
            <tr>
                <td><a href="{{ repo.repo_url }}">{{ repo.repo_slug }}</a></td>
                {% if repo.counts.still_open > 0 %}
                    {% assign still_open_url   = github_prs_url_prefix | append: "+state:open+created:<="   | append: sprint_end %}
                    {% assign closed_after_url = github_prs_url_prefix | append: "+state:closed+created:<=" | append: sprint_end | append: "+closed:>" | append: sprint_end %}
                    <td>{{ repo.counts.still_open }} (<a href="{{ still_open_url }}">Open</a> + <a href="{{ closed_after_url }}">Closed</a>)</td>
                {% else %}
                    <td>{{ repo.counts.still_open }}</td>
                {% endif %}
            </tr>
        {% endfor %}
    </table>
</div>
